\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}

\usepackage{listings}
\lstdefinelanguage{scala}{
  morekeywords={abstract,case,catch,class,def,%
    do,else,extends,false,final,finally,%
    for,if,implicit,import,match,mixin,%
    new,null,object,override,package,%
    private,protected,requires,return,sealed,%
    super,this,throw,trait,true,try,%
    type,val,var,while,with,yield},
  otherkeywords={=>,<-,<\%,<:,>:,\#,@},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[n]{/*}{*/},
  morestring=[b]",
  morestring=[b]',
  morestring=[b]"""
}

\usepackage{color}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\lstset{frame=tb,
  language=scala,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  frame=single,
  breaklines=true,
  breakatwhitespace=true
  tabsize=3
}

\title{Semester project -- Pong Designer\\Technical report}
\author{Lomig MÃ©gard}

\begin{document}
\maketitle

\section{Expressions and statements}


\section{Game objects}
This project uses JBox2D version 2.2.1.1 for its physical engine. Since Pong Designer needs to handle the history of all properties, a wrapper named \texttt{PhysicalObject} is built around each JBox2D body. It takes care of instantiating the body with arbitrary expressions in the world and of managing the different properties with their history. 

\begin{figure*}[h]
\centering
\includegraphics[scale = 0.7]{images/objects} 
\caption{Hierarchy of game objects.}
\label{fig:objects}
\end{figure*}

The figure \ref{fig:objects} describes how different kinds of game objects inherit from the same trait \texttt{GameObject}. It manages all the properties that belong to its implementation in two ways. First, each property is a class member of \texttt{GameObject} or of another sub-class if it is specific (an example is the circle radius). These members can be accessed only from the game engine itself, not from the user. This permits to have internally the right static Scala type for each property. Secondly, a map stores all the properties, even the ones declared in sub-classes, with their name for key. This enables the user to have access to a property from a name, but the precise type will remain unknown (it is anyway not required by the user). The following example shows how we can build a statement to increment a value.

\begin{lstlisting}
circle("x") := circle("x") + 1
\end{lstlisting}

This syntax is not very convenient but we assumed that this code would be generated by the game engine. It remains readable and meaningful.


\section{Categories}

\section{Game loop}

- Fixed time step

\subsection{Update}

During the execution of the \texttt{update()} loop:
\begin{enumerate}
\item execute the rules. The context is available and contains all asynchronous events recorded since the last iteration.
\item new values (from the rules) are flushed to the physics engine.
\item perform the physics engine \texttt{step} which computes new collisions and moves the objects.
\item load new values (from the physics engine) to the upper layer of objects.
\item save the current state to the history.
\end{enumerate}

\subsection{Render}







\end{document}
